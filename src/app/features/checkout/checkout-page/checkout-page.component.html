<section class="checkout container">
  <h1>Finalizar Compra</h1>
  <p class="subtitle">Revise seus dados e confirme o pedido</p>

  <div class="checkout-grid">
    <!-- FORMULÁRIO -->
    <form class="checkout-form">
      <h2>Dados do Cliente</h2>

      <label>
        Nome Completo
        <input
          type="text"
          placeholder="Digite seu nome"
          [(ngModel)]="name"
          name="name"
          required
          style="border: 2px solid #ccc; border-radius: 6px; padding: 6px;"
        />
      </label>

      <label>
        Email
        <input
          type="email"
          placeholder="Digite seu e-mail"
          [(ngModel)]="email"
          name="email"
          required
          style="border: 2px solid #ccc; border-radius: 6px; padding: 6px;"
        />
      </label>

      <label>
        CEP
        <input
          type="text"
          placeholder="00000-000"
          [(ngModel)]="cep"
          name="cep"
          (blur)="lookupCEP()"
          required
          style="border: 2px solid #ccc; border-radius: 6px; padding: 6px;"
        />
      </label>

      <label>
        Rua
        <input
          type="text"
          [(ngModel)]="street"
          name="street"
          readonly
          style="border: 2px solid #ccc; border-radius: 6px; padding: 6px; background-color: #f5f5f5;"
        />
      </label>

      <label>
        Cidade
        <input
          type="text"
          [(ngModel)]="city"
          name="city"
          readonly
          style="border: 2px solid #ccc; border-radius: 6px; padding: 6px; background-color: #f5f5f5;"
        />
      </label>

      <h2>Forma de Pagamento</h2>
      <div class="payment-methods">
        <label><input type="radio" name="payment" checked /> PIX</label>
        <label><input type="radio" name="payment" /> Cartão de Crédito</label>
        <label><input type="radio" name="payment" /> Boleto Bancário</label>
      </div>
    </form>

    <!-- RESUMO DO PEDIDO -->
    <aside class="checkout-summary">
      <h2>Resumo do Pedido</h2>

      <div class="alert success" *ngIf="orderConfirmed">
        ✅ Pedido confirmado com sucesso! Obrigado por comprar conosco.
      </div>

      <!-- ITENS DO CARRINHO -->
      <div class="summary-item" *ngFor="let item of cartItems">
        <span>{{ item.title }} (x{{ item.quantity }})</span>
        <span>
          {{ (item.price * item.quantity) | currency:'BRL':'symbol-narrow':'1.2-2' }}
        </span>
      </div>

      <!-- FRETE -->
      <app-shipping-calc (freightSelected)="onFreightSelected($event)"></app-shipping-calc>

      <!-- PAGAMENTO -->
      <app-payment-widget (paid)="onPaid($event)"></app-payment-widget>

      <!-- TOTAIS -->
      <div class="summary-item">
        <span>Subtotal</span>
        <span>{{ subtotal | currency:'BRL':'symbol-narrow':'1.2-2' }}</span>
      </div>

      <div class="summary-item" *ngIf="shippingCost > 0">
        <span>Frete</span>
        <span>{{ shippingCost | currency:'BRL':'symbol-narrow':'1.2-2' }}</span>
      </div>

      <div class="summary-total">
        <strong>Total:</strong>
        <strong>{{ total | currency:'BRL':'symbol-narrow':'1.2-2' }}</strong>
      </div>

      <!-- BOTÃO CONFIRMAR -->
      <button class="btn-confirm" (click)="confirmOrder()">Confirmar Pedido</button>
    </aside>
  </div>
</section>
